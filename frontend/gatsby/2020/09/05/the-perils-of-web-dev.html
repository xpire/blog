<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>The Quest for a cool header design | Justin’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="The Quest for a cool header design" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Something seemingly simple to implement becomes the most annoying thing to implement ever." />
<meta property="og:description" content="Something seemingly simple to implement becomes the most annoying thing to implement ever." />
<link rel="canonical" href="https://blog.justinor.dev/frontend/gatsby/2020/09/05/the-perils-of-web-dev.html" />
<meta property="og:url" content="https://blog.justinor.dev/frontend/gatsby/2020/09/05/the-perils-of-web-dev.html" />
<meta property="og:site_name" content="Justin’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-05T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Something seemingly simple to implement becomes the most annoying thing to implement ever.","url":"https://blog.justinor.dev/frontend/gatsby/2020/09/05/the-perils-of-web-dev.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.justinor.dev/frontend/gatsby/2020/09/05/the-perils-of-web-dev.html"},"headline":"The Quest for a cool header design","dateModified":"2020-09-05T00:00:00-05:00","datePublished":"2020-09-05T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.justinor.dev/feed.xml" title="Justin's Blog" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Justin&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The Quest for a cool header design</h1><p class="page-description">Something seemingly simple to implement becomes the most annoying thing to implement ever.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-09-05T00:00:00-05:00" itemprop="datePublished">
        Sep 5, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#frontend">frontend</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#gatsby">gatsby</a>
        
      
      </p>
    

    </header>

  <div class="main">
    <nav class="post-nav post-content">
      <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#inverting-colors">Inverting Colors</a>
<ul>
<li class="toc-entry toc-h2"><a href="#try-1-backdrop-filter">Try 1: backdrop-filter</a></li>
<li class="toc-entry toc-h2"><a href="#try-2-back-to-mix-blend-mode">Try 2: back to mix-blend-mode</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#fouc">FOUC</a>
<ul>
<li class="toc-entry toc-h2"><a href="#try-1---maybe-material-ui">Try 1 - Maybe Material-ui?</a></li>
<li class="toc-entry toc-h2"><a href="#try-2---styledcomponents">Try 2 - styled(components)</a></li>
</ul>
</li>
</ul>
    </nav>
    <div class="post-main post-content e-content" itemprop="articleBody">
     <p>When I first came up with the idea to highlight the current page with a rounded box, it sounded really easy to implement. I even decided to go really simple and make it just invert the background. So in <code class="language-plaintext highlighter-rouge">light</code> mode, it would be a black box which had white text insde, and the opposite for dark mode. What could go wrong?</p>

<blockquote>
  <p>everything.</p>
</blockquote>

<p>Lets go through some of the blood sweat and tears I went through so you don’t have to go through the same!</p>

<h1 id="inverting-colors">Inverting Colors</h1>

<p>Essentially, I saw this css-tricks article about <a href="https://css-tricks.com/methods-contrasting-text-backgrounds/">contrasting text backgrounds</a> which involved using the <code class="language-plaintext highlighter-rouge">mix-blend-mode: difference;</code> CSS on the foreground so that it would invert its background. This would work flawlessly for the dark background with white foreground, and its also the example they gave in this article:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">header</span> <span class="p">{</span>
  <span class="nl">background</span><span class="p">:</span> <span class="sx">url(black-and-white-image.jpg)</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">h2</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
  <span class="py">mix-blend-mode</span><span class="p">:</span> <span class="n">difference</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>However, try to do it for the opposite case and things come crashing down.</p>

<h2 id="try-1-backdrop-filter">Try 1: backdrop-filter</h2>

<p>I initially tried using this CSS, which applies a filter to the background of this image - this is actually how I have blurred everything when a user clicks the sandwich menu in mobile view. When combined with <code class="language-plaintext highlighter-rouge">contrast(2)</code> I was able to get commendable results on chrome. However, as soon as I tried using the website with firefox, the backdrop filter was no where to be found! This is because Mozilla Firefox have <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/backdrop-filter">hidden the feature behind an experimental flag</a>…</p>

<h2 id="try-2-back-to-mix-blend-mode">Try 2: back to mix-blend-mode</h2>

<p>So I went back to the original method, and decided on figuring out how to have this inverted color idea work for both light and dark modes. Essentially, I’ve found that I need to do the following things:</p>

<ul>
  <li>color the text normally</li>
  <li>color the inverting div <strong>white</strong>, with <code class="language-plaintext highlighter-rouge">mix-blend-mode: difference</code></li>
  <li><strong>wrap everything in a div which provides the colors:</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">background: var(--color-background)</code></li>
      <li><code class="language-plaintext highlighter-rouge">color: var(--color-text)</code></li>
      <li>transitions to make toggling the color easier on the eye</li>
    </ul>
  </li>
</ul>

<p>These things in <strong>bold</strong> took me very long to figure out~</p>

<p>Especially the <strong>div that provides colors</strong>, you can’t apply the color to the body, it needs to be in a div you style, or else in Chrome it results in the <code class="language-plaintext highlighter-rouge">mix-blend-mode</code> failing, BUT IT WORKS FINE IN FIREFOX!!</p>

<p>So many times, it would either only work in chrome, only work in firefox, only dark mode works, only light mode works. Shout out to my <a href="https://atharvdamle.com/">friend</a> who provided me support in my darkest moments, he was the one to suggesting making the inverting div <strong>white</strong>, very smart guy.</p>

<p>In code, here is a watered down example consisting only the color variables required to pull off this effect (note that <code class="language-plaintext highlighter-rouge">Underline</code> should have absolute position and overlap with the text in <code class="language-plaintext highlighter-rouge">StyledLink</code>):</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// styles</span>
<span class="kd">const</span> <span class="nx">ColorProvider</span> <span class="o">=</span> <span class="nx">styled</span><span class="p">.</span><span class="nx">div</span><span class="s2">`
  background: var(--color-background);
  color: var(--color-text);
  transition: all 0.25s linear;
`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Underline</span> <span class="o">=</span> <span class="nx">styled</span><span class="p">(</span><span class="nx">motion</span><span class="p">.</span><span class="nx">div</span><span class="p">)</span><span class="s2">`
  mix-blend-mode: difference;
  background-color: white;
`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">StyledLink</span> <span class="o">=</span> <span class="nx">styled</span><span class="p">(</span><span class="nx">Link</span><span class="p">)</span><span class="s2">`
  color: var(--color-text);
`</span><span class="p">;</span>

<span class="c1">// code</span>
<span class="p">&lt;</span><span class="nc">ColorProvider</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nc">Underline</span> <span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nc">StyledLink</span><span class="p">&gt;</span>Home<span class="p">&lt;/</span><span class="nc">StyledLink</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nc">ColorProvider</span><span class="p">&gt;;</span>
</code></pre></div></div>

<h1 id="fouc">FOUC</h1>

<p>Flash of Unstyled Content is a prominent problem in Gatsby, as part of the reason why it can serve content so fast is because it prebuilds all the html. Because it can serve the html so fast, more often than not, the html loads first before CSS styles are loaded in, resulting in blank white unstyled content flickering before the styles load in. I did not like this.</p>

<h2 id="try-1---maybe-material-ui">Try 1 - Maybe Material-ui?</h2>

<p>I was using <code class="language-plaintext highlighter-rouge">material-ui</code> as its my goto web-ui toolkit. However, I nearly considered giving up this toolkit while making this website. It appeared that whenever I used their <code class="language-plaintext highlighter-rouge">themeProvider</code>, it would completely break my styles, display a FOUC, and transitions applied to the body did not apply to any <code class="language-plaintext highlighter-rouge">material-ui</code> components.</p>

<p>However, I soon learnt that I was mistaken, as I had followed the documentation for <code class="language-plaintext highlighter-rouge">material-ui</code> blindly, and used the <code class="language-plaintext highlighter-rouge">&lt;CssBaseline /&gt;</code> component because they used it. Short answer - this will screw up the original css in the page. This was particularly bad for my case, as I needed to define the themes with css variables or else a FOUC would occur on every page load as Gatsby would not know about the style.</p>

<p>However, even without <code class="language-plaintext highlighter-rouge">&lt;CssBaseline /&gt;</code>, things were still going sour, FOUC was showing, I was still awake at 2am trying to fix this.</p>

<h2 id="try-2---styledcomponents">Try 2 - styled(components)</h2>

<p>TURNS OUT: I’ve been applying global styles through a component <code class="language-plaintext highlighter-rouge">createGlobalStyle</code> from <code class="language-plaintext highlighter-rouge">'styled-components'</code>. This applied a style to the body which set the <code class="language-plaintext highlighter-rouge">background-color</code> and <code class="language-plaintext highlighter-rouge">color</code>. It doesn’t seem to work immediately on page load, resulting in a flash of white in dark mode, before a transition to the proper color. So now, I create my own div styled with in-line CSS defining those color css variables. The result works like a charm!</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">ColorProvider</span> <span class="o">=</span> <span class="nx">styled</span><span class="p">.</span><span class="nx">div</span><span class="s2">`
  background: var(--color-background);
  color: var(--color-text);
  transition: all 0.25s linear;
`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Layout</span><span class="p">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">FC</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">children</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;&gt;</span>
      <span class="p">&lt;</span><span class="nc">ColorProvider</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">Header</span> <span class="p">/&gt;</span>
        <span class="si">{</span><span class="nx">children</span><span class="si">}</span>
        <span class="p">&lt;</span><span class="nc">Footer</span> <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nc">ColorProvider</span><span class="p">&gt;</span>
    <span class="p">&lt;/&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>This is only the stuff I remembered that I fixed, there was so much trial and error, and me reloading the site 100 times, that I’ve probably forgotten half of the stuff I tried to do to fix these problems I had.</p>

    </div>
  </div><!-- this handles current visible status in toc-->
<script>
window.addEventListener('DOMContentLoaded', () => {
    
  let previousSection = null;
  
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      const id = entry.target.getAttribute('id');
      if (entry.intersectionRatio > 0) {
        document.querySelector(`nav li a[href="#${id}"]`).parentElement.classList.add('is-visible');
        previousSection = id;
        // console.log(`previousSection set to ${previousSection}`)
      } else {
        document.querySelector(`nav li a[href="#${id}"]`).parentElement.classList.remove('is-visible');
      }
    });
    
    let firstVisibleLink = document.querySelector('.is-visible > a').getAttribute('href');
    
    // console.log(`firstVisible: ${firstVisibleLink}`)
    // console.log(`previousSection: ${previousSection}`)
  
    document.querySelectorAll('.active').forEach(elem => elem.classList.remove('active'))
  
    if (firstVisibleLink) {
      document.querySelector(`.is-visible > a[href="${firstVisibleLink}"]`).parentElement.classList.add('active')
      // console.log(`firstVisible should be active`)
    }
  
    if (!firstVisibleLink && previousSection) {
      document.querySelector(
        `a[href="#${previousSection}"]`
      ).parentElement.classList.add('active')
      // console.log(`previousSection should be active`)

    }
  });
  
  // Track all sections that have an `id` applied
  document.querySelectorAll('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').forEach((section) => {
    observer.observe(section);
  });

});
</script><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="xpire/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/frontend/gatsby/2020/09/05/the-perils-of-web-dev.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Justin Or&#39;s personal Blog!</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/xpire" title="xpire"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/just_in_awe" title="just_in_awe"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
