<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Multiple blog types in Gatsby | Justin’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Multiple blog types in Gatsby" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How I configured blogs and project pages written in markdown to show on their respective pages" />
<meta property="og:description" content="How I configured blogs and project pages written in markdown to show on their respective pages" />
<link rel="canonical" href="https://blog.justinor.dev/gatsby/2020/09/06/multiple-blog-types.html" />
<meta property="og:url" content="https://blog.justinor.dev/gatsby/2020/09/06/multiple-blog-types.html" />
<meta property="og:site_name" content="Justin’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-06T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"How I configured blogs and project pages written in markdown to show on their respective pages","url":"https://blog.justinor.dev/gatsby/2020/09/06/multiple-blog-types.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.justinor.dev/gatsby/2020/09/06/multiple-blog-types.html"},"headline":"Multiple blog types in Gatsby","dateModified":"2020-09-06T00:00:00-05:00","datePublished":"2020-09-06T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.justinor.dev/feed.xml" title="Justin's Blog" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Justin&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Multiple blog types in Gatsby</h1><p class="page-description">How I configured blogs and project pages written in markdown to show on their respective pages</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-09-06T00:00:00-05:00" itemprop="datePublished">
        Sep 6, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#gatsby">gatsby</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#criteria">Criteria</a></li>
<li class="toc-entry toc-h1"><a href="#setting-up-gatsby">Setting up Gatsby</a>
<ul>
<li class="toc-entry toc-h2"><a href="#hooking-up-the-frontend">Hooking up the frontend</a></li>
<li class="toc-entry toc-h2"><a href="#resources">Resources</a></li>
</ul>
</li>
</ul><p><code class="language-plaintext highlighter-rouge">graphql</code> is was very confusing for me to use at first, but with the <code class="language-plaintext highlighter-rouge">___graphql</code> tool available during <code class="language-plaintext highlighter-rouge">gatsby develop</code>, I found that I could quickly learn how it works as I used it more and more. One of the issues I came across lately was trying to maintain two different markdown folders for blogs and projects respectively.</p>

<p>From my research, I found another guide on how to do this, but their guide was for gatsby version 1, and I found that the requirement of providing metadata for project markdown files was a bit redundant, as you will see below. So here is my guide for creating a projects folder for your project markdown files to be serve on gatsby.</p>

<h1 id="criteria">
<a class="anchor" href="#criteria" aria-hidden="true"><span class="octicon octicon-link"></span></a>Criteria</h1>

<ul>
  <li>You are using a set up similar to the the <a href="https://www.gatsbyjs.com/starters/gatsbyjs/gatsby-starter-blog/">gatsby starter blog</a>.</li>
  <li>You want a file structure like this</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>src
├── content
│   ├── blog
│   │   ├── blog1
│   │   │   └── index.md
│   │   └── blog2
│   │       └── index.md
│   └── projects
│       ├── project1
│       │   └── index.md
│       └── project2
│           └── index.md
└── src
    └── templates
        ├── BlogPost.tsx
        └── ProjectPost.tsx
</code></pre></div></div>

<p>Thats it! (nothing redundant like requiring a field to be added to each projects’ <code class="language-plaintext highlighter-rouge">index.md</code>…)</p>

<h1 id="setting-up-gatsby">
<a class="anchor" href="#setting-up-gatsby" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting up Gatsby</h1>

<p>In <code class="language-plaintext highlighter-rouge">gatsby-config.js</code>, add the following code in the plugins array:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">plugins</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">...</span>
    <span class="p">{</span>
      <span class="nl">resolve</span><span class="p">:</span> <span class="s2">`gatsby-source-filesystem`</span><span class="p">,</span>
      <span class="nx">options</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">path</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">__dirname</span><span class="p">}</span><span class="s2">/content/projects`</span><span class="p">,</span>
        <span class="nx">name</span><span class="p">:</span> <span class="s2">`projects`</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">...</span>
  <span class="p">]</span>
</code></pre></div></div>

<p>Next, in <code class="language-plaintext highlighter-rouge">gatsby-node.js</code>, we don’t need to change the graphql query at all! Instead, we need to conditionally create pages and nodes based on the path to the markdown files!</p>

<p>Assuming your graphql takes the <code class="language-plaintext highlighter-rouge">fileAbsolutePath</code> field from <code class="language-plaintext highlighter-rouge">allMarkdownRemark / edges / nodes</code> like so:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">graphql</span><span class="p">(</span>
  <span class="s2">`
    {
      allMarkdownRemark(
        sort: { fields: [frontmatter___date], order: DESC }
        limit: 1000
      ) {
        edges {
          node {
            fields {
              slug
            }
            fileAbsolutePath
            frontmatter {
              title
              tags
            }
          }
        }
      }
    }
  `</span>
<span class="p">);</span>
</code></pre></div></div>

<p>Then we can simply check this property to figure out whether to render this as a blog post or as a project post!</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">exports</span><span class="p">.</span><span class="nx">createPages</span> <span class="o">=</span> <span class="k">async</span> <span class="p">({</span> <span class="nx">graphql</span><span class="p">,</span> <span class="nx">actions</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">blogPost</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">`./src/templates/BlogPost.tsx`</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">tagPage</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">`./src/templates/TagsPage.tsx`</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">projectPost</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">`./src/templates/ProjectPost.tsx`</span><span class="p">);</span>

  <span class="cm">/* graphql query from above goes here */</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">errors</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="nx">result</span><span class="p">.</span><span class="nx">errors</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Create blog posts pages.</span>
  <span class="kd">const</span> <span class="nx">posts</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">allMarkdownRemark</span><span class="p">.</span><span class="nx">edges</span><span class="p">;</span>

  <span class="nx">posts</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">post</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">previous</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">===</span> <span class="nx">posts</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">?</span> <span class="kc">null</span> <span class="p">:</span> <span class="nx">posts</span><span class="p">[</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nx">node</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">next</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">?</span> <span class="kc">null</span> <span class="p">:</span> <span class="nx">posts</span><span class="p">[</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">node</span><span class="p">;</span>

    <span class="nx">createPage</span><span class="p">({</span>
      <span class="na">path</span><span class="p">:</span> <span class="nx">post</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">slug</span><span class="p">,</span>
      <span class="na">component</span><span class="p">:</span> <span class="sr">/blog/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">fileAbsolutePath</span><span class="p">)</span>
        <span class="p">?</span> <span class="nx">blogPost</span>
        <span class="p">:</span> <span class="nx">projectPost</span><span class="p">,</span>
      <span class="na">context</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">slug</span><span class="p">:</span> <span class="nx">post</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">slug</span><span class="p">,</span>
        <span class="nx">previous</span><span class="p">,</span>
        <span class="nx">next</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Finally, to ensure slugs get properly created, we need to use <code class="language-plaintext highlighter-rouge">createFilePath</code> to create the slugs for the above command conditionally like so:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">exports</span><span class="p">.</span><span class="nx">onCreateNode</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">actions</span><span class="p">,</span> <span class="nx">getNode</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">createNodeField</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">actions</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">internal</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">`MarkdownRemark`</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">createFilePath</span><span class="p">({</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">getNode</span> <span class="p">});</span>
    <span class="nx">createNodeField</span><span class="p">({</span>
      <span class="na">name</span><span class="p">:</span> <span class="s2">`slug`</span><span class="p">,</span>
      <span class="nx">node</span><span class="p">,</span>
      <span class="na">value</span><span class="p">:</span> <span class="s2">`/</span><span class="p">${</span>
        <span class="o">/</span><span class="nx">blog</span><span class="o">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">fileAbsolutePath</span><span class="p">)</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">blog</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">projects</span><span class="dl">'</span>
      <span class="p">}${</span><span class="nx">value</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
    <span class="p">});</span>
  <span class="p">}</span>
</code></pre></div></div>

<h2 id="hooking-up-the-frontend">
<a class="anchor" href="#hooking-up-the-frontend" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hooking up the frontend</h2>

<p>This is most of the “backend” work done, and the rest of the work consists of using this data. You can probably reuse the code examples given in the first resource I have linked below, or check out the <a href="https://github.com/xpire/website/tree/master/src/templates">source code for this blog you’re reading right now</a>. The harder part in my opinion was knowing how to use the absolute path in graphql in the page creation phase, as I really disliked having to label the <code class="language-plaintext highlighter-rouge">projects</code> markdown pages with an explicit field when I have already put it in its own folder.</p>

<h2 id="resources">
<a class="anchor" href="#resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resources</h2>

<ul>
  <li><a href="https://desktopofsamuel.com/building-gatsby-with-multiple-post-type">building gatsby with multiple post types</a></li>
  <li><a href="https://chipcullen.com/making-multiple-content-types-in-gatsby/">making multiple content types in gatsby</a></li>
</ul>

  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="xpire/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/gatsby/2020/09/06/multiple-blog-types.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Justin Or&#39;s personal Blog!</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/xpire" title="xpire"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/just_in_awe" title="just_in_awe"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
